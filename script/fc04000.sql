set heading off;
select
  COALESCE(FC04000.PFCRM, 'N/A') || ',' ||
  COALESCE(FC04000.UFCRM, 'N/A') || ',' ||
  COALESCE(FC04000.NRCRM, 'N/A') || ',' ||
  COALESCE(FC04000.NOMEMED, 'SN') || ',' ||
  COALESCE(FC04000.OBSERV, 'N/A') || ',' ||
  COALESCE(FC04200.CDFUN, 'N/A') || ',' ||
  COALESCE(FC04400.ENDER, 'N/A') || ',' ||
  COALESCE(FC04400.ENDNR, '0') || ',' ||
  COALESCE(FC04400.ENDCP, 'N/A') || ',' ||
  COALESCE(FC04400.BAIRR, 'N/A') || ',' ||
  COALESCE(FC04400.NRCEP, '00000-000') || ',' ||
  COALESCE(FC04400.MUNIC, 'N/A') || ',' ||
  COALESCE(FC04400.UNFED, 'SP') || ',' ||
  COALESCE(FC04400.NRDDD, '11') || ',' ||
  COALESCE(FC04400.NRTEL, '00000-0000') || ',' ||
  COALESCE(FC04400.NRDDD2, '11') || ',' ||
  COALESCE(FC04400.NRTEL2, '00000-0000')
from FC04000
left join FC04200 on FC04000.PFCRM = FC04200.PFCRM and FC04000.UFCRM = FC04200.UFCRM and FC04000.NRCRM = FC04200.NRCRM
left join FC04400 on FC04000.PFCRM = FC04400.PFCRM and FC04000.UFCRM = FC04400.UFCRM and FC04000.NRCRM = FC04400.NRCRM
where FC04000.DTCAD between '2025-04-01' and '2025-04-30';
