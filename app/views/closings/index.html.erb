<%= render "actions", title: "Lista de Fechamentos" %>

<div class="flex w-full flex-col my-10">
  <div class="overflow-x-auto">
    <table class="table-auto w-full xl:text-sm lg:text-xs font-semibold text-center">
      <thead class="xl:text-base lg:text-sm">
        <tr>
          <th>Fechamento</th>
          <th>Data inicial</th>
          <th>Data final</th>
          <th>Último envelope</th>
          <th>Ações</th>
        </tr>
      </thead>

      <tbody>
        <% @closings.each_with_index do |closing, index| %>
          <tr class="border-t border-black <%= index % 2 == 0 ? "bg-gray-200" : "bg-gray-100" %> h-10">
            <td>
              <%= link_to closing.closing, modify_for_this_closure_closings_path(id: closing.id),
                  data: { turbo_confirm: "Tem certeza que deseja passar a trabalhar com um novo fechamento?", turbo_method: :post },
                  class: "text-primary"
              %>
            </td>

            <td><%= closing.start_date.strftime("%d/%m/%Y") %></td>
            <td><%= closing.end_date.strftime("%d/%m/%Y") %></td>
            <td><%= closing.last_envelope.to_s.rjust(6, '0') %></td>

            <td>
              <button onclick="document.getElementById('edit_closing<%= closing.id %>').showModal();" title="Editar">
                <span class="material-symbols-outlined text-primary">edit</span>
              </button>

              <dialog id="edit_closing<%= closing.id %>" class="modal place-items-center">
                <%= render ModalComponent.new(form: render("form", closing: closing, title: "Editar fechamento", btn_save: "Atualizar")) %>
              </dialog>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <%= render PaginationComponent.new(pagy: pagy_nav(@pagy), pages: @pagy.pages) %>
</div>

<dialog id="modal_closing_create" class="modal place-items-center">
  <%= render ModalComponent.new(form: render("form", closing: @closing, title: "Novo fechamento", btn_save: "Salvar"), btn_back: "Fechar sem salvar") %>
</dialog>
